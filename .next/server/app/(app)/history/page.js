(()=>{var e={};e.id=584,e.ids=[584],e.modules={474:(e,t,r)=>{"use strict";r.d(t,{I0:()=>d,IP:()=>n,K1:()=>c,pi:()=>l,wj:()=>o});var s=r(75535),a=r(66639);let i=(0,s.aU)(a.yA),o=async(e,t)=>{try{if(!e)throw Error("User ID is required to save to history.");return(await (0,s.gS)((0,s.rJ)(i,`users/${e}/history`),{...t,userId:e,createdAt:s.Dc.now()})).id}catch(e){throw console.error("Error saving diagnosis to history:",e),Error("Could not save diagnosis.")}},n=async e=>{try{let t=(0,s.P)((0,s.rJ)(i,`users/${e}/history`),(0,s.My)("createdAt","desc")),r=await (0,s.GG)(t),a=[];return r.forEach(e=>{a.push({id:e.id,...e.data()})}),a}catch(t){console.error("Error getting diagnosis history: ",t);try{let t=(0,s.P)((0,s.rJ)(i,`users/${e}/history`)),r=(await (0,s.GG)(t)).docs.map(e=>({id:e.id,...e.data()}));return console.warn("Returned history without sorting. Please create a Firestore index for 'createdAt' descending."),r.sort((e,t)=>t.createdAt.toMillis()-e.createdAt.toMillis())}catch(e){throw console.error("Error getting diagnosis history on fallback: ",e),Error("Could not retrieve diagnosis history.")}}},l=async(e,t)=>{try{let r=(0,s.H9)(i,`users/${e}/history`,t),a=await (0,s.x7)(r);if(a.exists()){let e=a.data();return{id:a.id,...e}}return console.log("No such document!"),null}catch(e){throw console.error("Error getting document:",e),Error("Could not retrieve the diagnosis record.")}},d=async(e,t)=>{try{await (0,s.kd)((0,s.H9)(i,`users/${e}/history`,t))}catch(e){throw console.error("Error deleting diagnosis record:",e),Error("Could not delete diagnosis record.")}},c=async e=>{try{let t=(0,s.P)((0,s.rJ)(i,`users/${e}/history`)),r=await (0,s.GG)(t),a=(0,s.wP)(i);r.docs.forEach(e=>{a.delete(e.ref)}),await a.commit()}catch(e){throw console.error("Error deleting all user history:",e),Error("Could not delete all user history.")}}},2668:(e,t,r)=>{Promise.resolve().then(r.bind(r,83117))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15820:(e,t,r)=>{Promise.resolve().then(r.bind(r,65082))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},19895:(e,t,r)=>{Promise.resolve().then(r.bind(r,70718))},21820:e=>{"use strict";e.exports=require("os")},21844:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("CircleSlash",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"9",x2:"15",y1:"15",y2:"9",key:"1dfufj"}]])},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37366:e=>{"use strict";e.exports=require("dns")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},65082:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\agrovision-ai\\\\src\\\\app\\\\(app)\\\\history\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\agrovision-ai\\src\\app\\(app)\\history\\page.tsx","default")},66543:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d});var s=r(65239),a=r(48088),i=r(88170),o=r.n(i),n=r(30893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let d={children:["",{children:["(app)",{children:["history",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,65082)),"D:\\agrovision-ai\\src\\app\\(app)\\history\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,70718)),"D:\\agrovision-ai\\src\\app\\(app)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"D:\\agrovision-ai\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["D:\\agrovision-ai\\src\\app\\(app)\\history\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(app)/history/page",pathname:"/history",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},67760:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(60687),a=r(85814),i=r.n(a),o=r(16189),n=r(4780),l=r(24026),d=r(21068),c=r(44610),u=r(14283),h=r(58595),p=r(97905);let m=[{href:"/dashboard",label:"Home",icon:l.A},{href:"/diagnose",label:"Scan",icon:d.A},{href:"/history",label:"History",icon:c.A},{href:"/chat",label:"Chat",icon:u.A},{href:"/profile",label:"Profile",icon:h.A}];function x(){let e=(0,o.usePathname)();return(0,s.jsx)(p.P.nav,{className:"fixed bottom-0 left-0 right-0 z-50 md:hidden bg-background/80 backdrop-blur-sm border-t",initial:{y:100},animate:{y:0},transition:{type:"spring",stiffness:300,damping:30},children:(0,s.jsx)("div",{className:"grid h-16 grid-cols-5",children:m.map(t=>{let r="/dashboard"===t.href?e===t.href:e.startsWith(t.href);return(0,s.jsxs)(i(),{href:t.href,className:"flex flex-col items-center justify-center gap-1 text-xs transition-colors text-muted-foreground hover:text-primary",children:[(0,s.jsx)(p.P.div,{whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,s.jsx)(t.icon,{className:(0,n.cn)("w-6 h-6",r?"text-primary":"")})}),(0,s.jsx)("span",{className:(0,n.cn)(r?"text-primary font-semibold":""),children:t.label})]},t.href)})})})}var f=r(94556),y=r(49315);r(43210);var v=r(11516);let g=["/login","/signup"];function j({children:e}){let{user:t,loading:r}=(0,y.A)();(0,o.useRouter)();let a=(0,o.usePathname)();return!r&&(t||g.includes(a))?(0,s.jsx)(s.Fragment,{children:e}):(0,s.jsx)("div",{className:"flex h-screen w-full items-center justify-center",children:(0,s.jsx)(v.A,{className:"h-8 w-8 animate-spin"})})}function b({children:e}){return(0,s.jsx)(j,{children:(0,s.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,s.jsx)(f.A,{}),(0,s.jsx)(p.P.main,{className:"flex-1 p-4 pt-20 pb-24 md:p-6 md:pt-24 lg:p-8 lg:pt-28",initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:(0,s.jsx)("div",{className:"mx-auto max-w-7xl w-full",children:e})}),(0,s.jsx)(p.P.footer,{className:"border-t py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:(0,s.jsxs)("div",{className:"container mx-auto px-4 text-center text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex justify-center gap-4 mb-4",children:[(0,s.jsx)(i(),{href:"/terms-of-use",className:"hover:text-primary text-sm",children:"Terms of Use"}),(0,s.jsx)(i(),{href:"/privacy-policy",className:"hover:text-primary text-sm",children:"Privacy Policy"})]}),(0,s.jsxs)("p",{className:"text-sm",children:["\xa9 ",new Date().getFullYear()," AgroVision AI. All rights reserved."]})]})}),(0,s.jsx)(x,{})]})})}},70718:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\agrovision-ai\\\\src\\\\app\\\\(app)\\\\layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\agrovision-ai\\src\\app\\(app)\\layout.tsx","default")},73039:(e,t,r)=>{Promise.resolve().then(r.bind(r,67760))},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83117:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(60687),a=r(43210),i=r(49315),o=r(474),n=r(44493),l=r(29523),d=r(96834),c=r(11516);let u=(0,r(82614).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var h=r(21844),p=r(29867),m=r(85814),x=r.n(m),f=r(16189),y=r(93500),v=r(97905);let g={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},j={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};function b(){let{user:e,loading:t}=(0,i.A)();(0,f.useRouter)();let[r,m]=(0,a.useState)([]),[b,w]=(0,a.useState)(!0),{toast:N}=(0,p.dj)();(0,a.useCallback)(async()=>{if(e)try{w(!0);let t=await (0,o.IP)(e.uid);m(t)}catch(e){console.error(e),N({variant:"destructive",title:"Error",description:"Failed to load diagnosis history."})}finally{w(!1)}},[e,N]);let P=async t=>{if(e)try{await (0,o.I0)(e.uid,t),m(e=>e.filter(e=>e.id!==t)),N({title:"Deleted",description:"Diagnosis record has been removed."})}catch(e){console.error(e),N({variant:"destructive",title:"Error",description:"Failed to delete the record."})}};return b||t?(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)(c.A,{className:"w-8 h-8 animate-spin text-primary"})}):(0,s.jsxs)(v.P.div,{className:"container mx-auto max-w-5xl",variants:g,initial:"hidden",animate:"visible",children:[(0,s.jsxs)("div",{className:"mb-8 text-center md:text-left",children:[(0,s.jsx)("h1",{className:"font-headline text-3xl md:text-4xl font-bold tracking-tight",children:"Diagnosis History"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Review your past plant health scans and their outcomes."})]}),r.length>0?(0,s.jsx)(v.P.div,{className:"grid gap-6",variants:g,children:r.map(e=>(0,s.jsx)(v.P.div,{variants:j,children:(0,s.jsxs)(n.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(n.ZB,{className:"text-2xl font-headline",children:[e.plantIdentification.commonName," - ",e.diseaseName]}),(0,s.jsx)(n.BT,{className:"text-base",children:e.createdAt.toDate().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),(0,s.jsx)(d.E,{variant:"healthy"===e.diseaseName.toLowerCase()?"default":"destructive",className:"self-start md:self-center",children:e.diseaseName})]})}),(0,s.jsx)(n.Wu,{children:(0,s.jsx)("p",{className:"text-muted-foreground line-clamp-2",children:e.summary})}),(0,s.jsxs)(n.wL,{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,s.jsx)(x(),{href:`/history/${e.id}`,className:"w-full sm:w-auto",children:(0,s.jsx)(l.$,{variant:"outline",className:"w-full",children:"View Details"})}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsxs)(y.Lt,{children:[(0,s.jsx)(y.tv,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-destructive",children:(0,s.jsx)(u,{className:"h-4 w-4"})})}),(0,s.jsxs)(y.EO,{children:[(0,s.jsxs)(y.wd,{children:[(0,s.jsx)(y.r7,{children:"Are you sure?"}),(0,s.jsx)(y.$v,{children:"This action cannot be undone. This will permanently delete this diagnosis record."})]}),(0,s.jsxs)(y.ck,{children:[(0,s.jsx)(y.Zr,{children:"Cancel"}),(0,s.jsx)(y.Rx,{onClick:()=>P(e.id),children:"Delete"})]})]})]})})]})]})},e.id))}):(0,s.jsxs)(v.P.div,{className:"text-center py-16 border-2 border-dashed rounded-lg flex flex-col items-center gap-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},children:[(0,s.jsx)(h.A,{className:"w-12 h-12 text-muted-foreground"}),(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"No History Yet"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Start by scanning a plant to see your history here."}),(0,s.jsx)(l.$,{asChild:!0,children:(0,s.jsx)(x(),{href:"/diagnose",children:"Scan a Plant"})})]})]})}},91645:e=>{"use strict";e.exports=require("net")},93500:(e,t,r)=>{"use strict";r.d(t,{$v:()=>f,EO:()=>h,Lt:()=>l,Rx:()=>y,Zr:()=>v,ck:()=>m,r7:()=>x,tv:()=>d,wd:()=>p});var s=r(60687),a=r(43210),i=r(74424),o=r(4780),n=r(29523);let l=i.bL,d=i.l9,c=i.ZL,u=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.hJ,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));u.displayName=i.hJ.displayName;let h=a.forwardRef(({className:e,...t},r)=>(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsx)(i.UC,{ref:r,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));h.displayName=i.UC.displayName;let p=({className:e,...t})=>(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});p.displayName="AlertDialogHeader";let m=({className:e,...t})=>(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});m.displayName="AlertDialogFooter";let x=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.hE,{ref:r,className:(0,o.cn)("text-lg font-semibold",e),...t}));x.displayName=i.hE.displayName;let f=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.VY,{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",e),...t}));f.displayName=i.VY.displayName;let y=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.rc,{ref:r,className:(0,o.cn)((0,n.r)(),e),...t}));y.displayName=i.rc.displayName;let v=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.ZD,{ref:r,className:(0,o.cn)((0,n.r)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));v.displayName=i.ZD.displayName},94735:e=>{"use strict";e.exports=require("events")},96834:(e,t,r)=>{"use strict";r.d(t,{E:()=>n});var s=r(60687);r(43210);var a=r(24224),i=r(4780);let o=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:t,...r}){return(0,s.jsx)("div",{className:(0,i.cn)(o({variant:t}),e),...r})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[828,361,658,447,891,637,424,423,259],()=>r(66543));module.exports=s})();